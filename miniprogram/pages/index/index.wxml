<!--index.wxml-->
<wxs src="../../utils/filters.wxs" module="f"></wxs>

<!-- 自定义导航栏（含搜索框） -->
<view class="custom-nav" style="height: {{navBarHeight}}px; padding-top: {{statusBarHeight}}px;">
  <view class="nav-row" style="height: {{navBarHeight}}px; padding-right: {{capsuleRightWidth}}px;">
    <view class="search-box" style="height: {{menuHeight}}px;" bindtap="openSearchPage">
      <input class="search-input" style="height: 100%;" placeholder="{{(require('../../config.js').searchPlaceholder)||'搜索（支持镜架型号，镜架尺寸/总长/高度）'}}" value="{{searchDisplay}}"/>
      <view wx:if="{{searchDisplay}}" class="search-clear" catchtap="clearSearch">清空</view>
    </view>
  </view>
</view>
<!-- 占位，避免内容被导航栏遮挡 -->
<view style="height: {{navHeight}}px;"></view>

<view class="container">
  <view class="product-list">
    <view class="product-item" wx:for="{{products}}" wx:key="frame_model" bindtap="goToDetail" data-model="{{item.frame_model}}">
      <image class="product-image" src="{{f.firstImage(item.images)}}" mode="aspectFit"></image>
      <view class="product-info">
        <text class="product-title">型号：{{f.display(item.frame_model)}}</text>
        <view class="product-specs">
          <text>镜架尺寸：{{f.unit(item.lens_size, '')}}-{{f.unit(item.nose_bridge_width, '')}}-{{f.unit(item.temple_length, '')}}</text>
          <text>价格：￥{{f.display(item.price)}}</text>
          <text>镜架总长：{{f.unit(item.frame_total_length, '')}}</text>
          <text>镜架高度：{{f.unit(item.frame_height, '')}}</text>
          <text>重量：{{f.unit(item.weight, 'g')}}</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{hasMore && !isLoading}}">
    <text bindtap="loadMore">加载更多</text>
  </view>
  <view class="loading" wx:if="{{isLoading}}">加载中...</view>
  <view class="no-more" wx:if="{{!hasMore && products.length > 0 && !isLoading}}">没有更多了</view>
</view>